üß™ Mixed-Signal Sensor Interface & FPGA Processing Pipeline

Verilog ‚Ä¢ LTspice ‚Ä¢ Vivado ‚Ä¢ Python ‚Ä¢ Zybo Z7

This repository contains the complete workflow for a mixed-signal analog front-end (AFE), digital processing pipeline, and telemetry interface (UART/SPI-style) implemented on an FPGA and validated with Python tooling.

The project includes:

LTspice analog simulations

Verilog RTL for comparators, latch logic, edge counters, UART transmitter

Vivado testbenches + waveform configs

Python scripts for analyzing AFE data, decoding UART, and simulating GPIO behavior

CSV waveform datasets for debugging and machine-learning preprocessing

üìÇ Repository Structure
ecenprojviv/  
AFE_top.op.raw  
AFE_top.plt  
AFE_top.raw  
AFE_transient.csv  
afe_plot.png  
afe_simold.csv  
afe_waveforms.png  
detect_events_min.py  
events.csv  
plot_afe_sim.py  
simulate_gpio.py  
simulate_gpio_realtime.py  
uart_decode.py  

üîß Verilog / FPGA Files (ecenprojviv folder)

This contains all the RTL used to build the digital processing pipeline:

afe_top.v

Top-level FPGA module.
Includes:

Digital comparator output

SR latch-based hysteresis logic

Optional FIR filter stage

UART/SPI-style output telemetry

vin input bus for testbench feeding

schmitt_comparator.v

Implements a digital Schmitt trigger to replicate the analog hysteresis behavior in the AFE.

sr_latch.v

Implements the set‚Äìreset latch to detect clean rising/falling events and remove comparator chatter.

edge_counter.v

Counts edges or events (useful for frequency measurement, threshold detection, envelope buildup).

uart_tx.v

Implements a lightweight UART transmitter that outputs filtered sensor data or event flags at a fixed baud rate.

afe_tb.v

Main testbench that:

Sweeps VIN input

Generates CSV logs

Captures rising/falling thresholds

Writes everything into afe_sim.csv

This file controls your entire simulation ‚Üí clock, reset, sweep, timing, CSV logging.

üìä AFE / LTspice Simulation Data
AFE_top.op.raw / AFE_top.raw / AFE_top.plt

Raw outputs from LTspice.
Contain:

DC operating point

Transient waveforms

Plot configurations

Used to validate analog gain, bandwidth, hysteresis, and noise behavior.

AFE_transient.csv

Exported LTspice transient run.
Includes:

Sensor input

Amplified output

Comparator input node voltages

Used by Python scripts (plot_afe_sim.py, detect_events_min.py) to validate analog ‚Üí digital transition.

afe_simold.csv

An older exported dataset from the Verilog testbench before UART integration.

afe_waveforms.png

Figure showing AFE behavior (gain, hysteresis switching, comparator output).

üêç Python Analysis Tools

These Python scripts allow you to test AFE performance, validate digital transitions, and decode FPGA telemetry.

plot_afe_sim.py

Plots analog CSV outputs from LTspice or Verilog:

vin

comparator output

latch output

filtered output

Used for debugging hysteresis and threshold points.

detect_events_min.py

Detects:

Rising threshold crossing

Falling threshold crossing

Computes hysteresis window

Generates events.csv

Used to validate that your SR-latch + comparator behave identically to your analog design.

simulate_gpio.py

Simulates FPGA GPIO behavior using pre-recorded event data.

Useful before running on Zybo hardware.

simulate_gpio_realtime.py

Same as above but operates in real time using a time.sleep loop ‚Äî emulates live FPGA output.

uart_decode.py

Decodes UART waveforms generated by the FPGA testbench.

Features:

Start-bit detection

Bit-period timing alignment

Stop-bit validation

Reconstructed bytes

Used for checking FPGA ‚Üí PC communication before hardware deployment.

üìÅ CSV Files
events.csv

Generated by detect_events_min.py
Contains:

time, event_type, vin_code

afe_sim.csv (Generated by testbench)

Main FPGA-side analog-to-digital log containing:

time_ns, vin_code, cmp_out, logic_out, uart_tx

üéØ What This Project Demonstrates
‚úî Mixed-Signal AFE modeling

Analog gain, filters, hysteresis, comparator behavior

‚úî Digital signal-conditioning pipeline

FIR filtering ‚Üí Comparator ‚Üí SR latch ‚Üí Edge detection

‚úî Verilog implementation on FPGA

Synthesizable modules validated with Vivado

‚úî Telemetry via UART/SPI

FPGA sends out sensor thresholds + edges for AI preprocessing

‚úî Python visualization + decoding

Plots, event detection, UART frame decode

üöÄ How to Run the Project
1. Run LTspice analog simulations

Open any .raw or .plt file in LTspice.

2. Run FPGA simulation (Vivado)
launch_simulation
run 2 ms


Make sure afe_tb.v is the top module.

3. Generate CSV output

Vivado testbench automatically writes:

afe_sim.csv

4. Analyze Digital Behavior
python plot_afe_sim.py
python detect_events_min.py

5. Decode UART telemetry
python uart_decode.py

6. Emulate GPIO behavior
python simulate_gpio.py
python simulate_gpio_realtime.py

ü§ù Contributing

Pull requests welcome.
If you want to extend:

SPI output

Fixed-point FIR filtering

On-FPGA ML preprocessing

feel free to open an issue.

üìú License

MIT License.
